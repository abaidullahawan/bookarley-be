<style>
  .dropdown-menu-width {
    width: 91%;
    margin-left: 20px;
  }

  .circle-image {
    width: 40px;
    height: 40px;
    border: 0.5px solid lightgray;
    border-radius: 50%;
    object-fit: cover;
    z-index: 1;
  }
  
  .all-cat-dropdown{
    margin-bottom: -5px;
    margin-top: 5px;
    margin-right: 10px;
    margin-left: 20px;
    background: white;
    width: 225px;
    padding-top: 15px !important;
    padding-bottom: 15px !important;
    border-top-left-radius: 5px !important;
    border-top-right-radius: 5px !important;
    border-bottom-right-radius: 0px !important;
    border-bottom-left-radius: 0px !important;
    font-weight: bold;
  }
  .dropdown-toggle::after {
    display: none;
  }

  .all-ctg-text{
    float: left;
    color: black;
    font-weight: 500;
    margin-left: 25px;
    font-size: 1.3rem;
  }

  .ctg-list-text{
    color: black;
    font-weight: 500;
    margin-left: 22px;
    font-size: 1.35rem;
  }

  .all-ctg-icon{
    float: right;
    color: black;
    margin-top: 6px;
    margin-right: 11px;
  }

  .navbar-nav .nav-gap {
    margin-right: 5px;
  }

  .dropbtn {
    padding: 16px;
    border: none;
    cursor: pointer;
  }

  .taxonomy-link:hover{
    background: #ECEEF2;
    border-left: 8px solid #F29F37;
  }

  .dropdown {
    position: relative;
    display: inline-block;
  }

  .dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    box-shadow: 0px 8px 8px 0px rgba(0,0,0,0.2);
    z-index: 1;
  }

  .dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    font-size: 1.2em;
  }

  .show {display:block;}

  .custom-dropdown {
    position: relative;
    display: inline-block;
  }
  
  .dropdown-content-unique {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
    right: 0px;
    top: 38px;
    cursor: pointer;
  }
  
  .custom-dropdown:hover .dropdown-content-unique {
    display: block;
  }

  .taxonomy-dropdown-hover {
    position: relative;
    display: inline-block;
  }

  .more-submenu {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
    padding: 5px; 
    width: 200px; 
    border-bottom: 8px solid #f29f37;
    border-radius: 8px;  
  }

  .more-submenu a {
    text-decoration: none;
  }

  .taxonomy-dropdown-hover:hover .more-submenu {
    display: block;
  }
  .sidemenu{
    font-size: 1em !important;
  }

  .seller-btn{
    padding: 8px 22px;
  }
  .seller-btn:hover {
    background-color: #eeac59 !important;
    color: #1e396b !important;
    border: 2px solid #eeac59;
}
</style>

<nav class="navbar navbar-expand-lg navbar-dark fixed-top mobile-nav-hidden py-2" style="z-index: 2; margin-top: 73px; background: #1e396b;">
    <div class="container-fluid">
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <!-- Example Dropdown -->
            <div class="dropdown">
                <!-- Dropdown Toggle Button -->
                <button class="btn btn-light text-dark dropdown-toggle all-cat-dropdown dropbtn" onclick="ctgDropDown()">
                    <span class="all-ctg-text" onclick="ctgDropDown()">All Categories</span><i class="fas fa-chevron-down all-ctg-icon"></i>
                </button>

                <!-- Dropdown Menu -->
                <div class="dropdown-menu dropdown-content dropdown-menu-width" style="border: none;" id="myDropdown">
                    <% Spree::Taxonomy.all.each do |taxonomy| %>
                      <div class="dropdown-wrapper">
                        <% taxonomy_permalink = taxonomy.taxons.where(name: taxonomy.name)&.first&.permalink%>
                        <%= link_to "/t/#{taxonomy_permalink}", class: "taxonomy-link" do %>
                          <% if taxonomy.icon.attached? %>
                            <%= render(ImageComponent.new(image: taxonomy.icon, size: :small, itemprop: "image", style: "width: 20px;")) %>
                          <% end %>
                          <span style="margin-left: 8px; color: #3f3b3b;"><%= taxonomy.name %></span>
                          <span style="float: right;"><i class="fas fa-angle-right" style="color: #3f3b3b;"></i></span>
                        <%end%>
                        
                        <% parent_taxons = taxonomy&.root&.children %>
                        <% if parent_taxons&.any? %>
                          <div class="taxonomy-dropdown-all shadow py-2 px-4" style="border-radius: 8px;">
                            <div class="parent-taxon row">
                              <div class="col-lg-9">
                                <div class="row">
                                  <% if taxonomy.name != 'E-Invitations' %>
                                    <% taxonomy.root.children.each do |parent_taxon| %>
                                      <div class="col-md-4 taxon_name">
                                        <% parent_permalink = parent_taxon&.permalink%>
                                        <%= link_to "/t/#{parent_permalink}", style:"color: #1e396b;" do %>
                                          <%= parent_taxon.name %>
                                        <%end%>
                                        <div class="child-taxons mb-5">
                                          <% parent_taxon.children.each do |child_taxon| %>
                                          <%child_permalink = child_taxon&.permalink%>
                                          <%= link_to "/t/#{child_permalink}" do %>
                                            <span class="child-taxons-name sidemenu my-2"><%= child_taxon.name %></span>
                                            <%end%>
                                          <% end %>
                                        </div>
                                      </div>
                                    <% end %>
                                  <%else%>
                                    <% InvitationCategory.where(parent_id: nil).each do |invitation_category| %>
                                      <div class="col-md-4 taxon_name">
                                        <%= link_to invitation_cards_path(q: { invitation_categories_id_eq: invitation_category.id }), style:"color: #1e396b;" do %>
                                          <%= invitation_category.name %>
                                        <% end %>
                                        <div class="child-taxons mb-5">
                                          <% InvitationCategory.where(parent_id: invitation_category.id)&.each do |invitation_sub_category| %>
                                            <%= link_to invitation_cards_path(q: { invitation_categories_id_eq: invitation_sub_category.id }) do %>
                                              <span class="child-taxons-name sidemenu my-2"><%= invitation_sub_category.name %></span>
                                            <% end %>
                                          <% end  %>
                                        </div>
                                      </div>
                                    <% end %>
                                  <% end %>  
                                </div>
                              </div>
                              <div class="col-lg-3 d-flex justify-content-center align-items-center">  
                                <% if taxonomy.name == 'Venues' %>
                                  <%= image_tag('venue-background.jpg', class: "w-100 h-100") %>
                                <% elsif taxonomy.name == 'Vendors' %>  
                                  <%= image_tag('vendor-background.jpg', class: "w-100 h-100") %>
                                <% elsif taxonomy.name == 'E-Invitations' %>  
                                  <%= image_tag('e-invite-background.jpg', class: "w-100 h-100") %>
                                <% elsif taxonomy.name == 'Party Suppliers' %>  
                                  <%= image_tag('party.png', class: "w-100 h-100") %>
                                <% elsif taxonomy.name == 'Real Estate' %>  
                                  <%= image_tag('real-estate-background.jpg', class: "w-100 h-100") %>
                                <% elsif taxonomy.name == 'Online Shopping' %>  
                                  <%= image_tag('online_shopping.jpg', class: "w-100 h-100") %>
                                <% else %>
                                  <% if taxonomy.icon.attached? %>
                                    <%= render(ImageComponent.new(image: taxonomy.icon, size: :small, itemprop: "image", style: "width: 100%;")) %>
                                  <% end %>
                                <% end %>
                              </div>  
                            </div>
                          </div>
                        <% end %>
                      </div>
                    <% end %>
                </div>
            </div>

           <div class="navbar-nav">
              <% Spree::Taxonomy.all.each do |taxonomy| %>
                <% taxonomy_permalink = taxonomy.taxons.where(name: taxonomy.name)&.first&.permalink%>
                <% invitation_permalink = invitation_cards_path %>
                <div class="nav-item nav-link nav-gap ctg-list-text active taxonomy-dropdown">
                  <% if taxonomy.name.downcase.include?('e-invitations') %>
                    <%= link_to invitation_permalink do %>
                      <span class="taxonomy-name"><%= taxonomy.name %></span>
                    <%end%>
                  <% else %>
                    <%= link_to "/t/#{taxonomy_permalink}" do %>
                      <span class="taxonomy-name"><%= taxonomy.name %></span>
                    <%end%>
                  <% end %>  
                  <% parent_taxons = taxonomy.root.children %>
                  <% if parent_taxons.any? %>
                    <div class="taxonomy-dropdown-content shadow py-2 px-4 mt-2">
                      <div class="parent-taxon row">
                        <div class="col-lg-9">
                          <div class="row">
                            <% if taxonomy.name != 'E-Invitations' %>
                              <% taxonomy.root.children.each do |parent_taxon| %>
                                <div class="col-md-4">
                                <% parent_permalink = parent_taxon&.permalink%>
                                  <%= link_to "/t/#{parent_permalink}", style:"color: #1E396B;" do %>
                                    <%= parent_taxon.name %>
                                  <%end%>
                                  <div class="child-taxons mb-5">
                                    <% parent_taxon.children.each do |child_taxon| %>
                                      <%child_permalink = child_taxon&.permalink%>
                                      <%= link_to "/t/#{child_permalink}" do %>
                                        <span class="child-taxons-name my-2"><%= child_taxon.name %></span>
                                      <%end%>
                                    <% end %>
                                  </div>
                                </div>
                              <% end %>
                            <% else %>
                              <% InvitationCategory.where(parent_id: nil).each do |invitation_category| %>
                                <div class="col-md-4">
                                  <%= link_to invitation_cards_path(q: { invitation_categories_id_eq: invitation_category.id }), style:"color: #1e396b;" do %>
                                    <%= invitation_category.name %>
                                  <% end %>
                                  <div class="child-taxons mb-5">
                                    <% InvitationCategory.where(parent_id: invitation_category.id)&.each do |invitation_sub_category| %>
                                      <%= link_to invitation_cards_path(q: { invitation_categories_id_eq: invitation_sub_category.id }) do %>
                                        <span class="child-taxons-name my-2"><%= invitation_sub_category.name %></span>
                                      <% end %>
                                    <% end  %>
                                  </div>
                                </div>
                              <% end %>
                            <% end %>
                          </div>
                        </div>
                        <div class="col-lg-3 d-flex justify-content-center align-items-center">
                          <% if taxonomy.name == 'Venues' %>
                            <%= image_tag('venue-background.jpg', class: "w-100 h-100") %>
                          <% elsif taxonomy.name == 'Vendors' %>  
                            <%= image_tag('vendor-background.jpg', class: "w-100 h-100") %>
                          <% elsif taxonomy.name == 'E-Invitations' %>  
                            <%= image_tag('e-invite-background.jpg', class: "w-100 h-100") %>
                          <% elsif taxonomy.name == 'Party Suppliers' %>  
                            <%= image_tag('party.png', class: "w-100 h-100") %>
                          <% elsif taxonomy.name == 'Real Estate' %>  
                            <%= image_tag('real-estate-background.jpg', class: "w-100 h-100") %>
                          <% elsif taxonomy.name == 'Online Shopping' %>  
                            <%= image_tag('online_shopping.jpg', class: "w-100 h-100") %>
                          <% else %>
                            <% if taxonomy.icon.attached? %>
                              <%= render(ImageComponent.new(image: taxonomy.icon, size: :small, itemprop: "image", style: "width: 100%;")) %>
                            <% end %>
                          <% end %>
                        </div>
                      </div>
                    </div>
                  <% end %>
                </div>
              <% end %>
            </div>
        </div>
       

        <div class="navbar-nav" style="margin-right: 26px">
          <% if !spree_current_user || !spree_current_user.admin? %>
            <% if spree_current_user.present? %>
              <a href="/seller_information" class="px-5 py-3 seller-btn btn btn-lg" type="button">
              <% if spree_current_user.has_spree_role?("seller")%>  
                Update Account
              <% else %>
                Become a Seller
              <% end %>  
              </a>
            <%else%>
              <%= link_to "Become a Seller", login_path, class: "px-5 py-3 seller-btn btn btn-lg" %>
            <% end %>
          <% end %>
        </div>
    </div>
</nav>

